<div
  class="control-panel db-glass-panel p-2 md:p-3 space-y-4 md:space-y-5 text-white rounded-xl max-w-md mx-auto"
>
  <div
    class="flex items-center justify-between mb-2 md:mb-3 border-b border-neon-pink/30 pb-1.5 flex-nowrap gap-2"
  >
    <h2 class="text-base font-bold db-neon-text tracking-widest whitespace-nowrap">
      System Controls
    </h2>
    <div class="text-[10px] font-mono text-neon-pink/50 animate-pulse whitespace-nowrap">
      STATUS: ACTIVE
    </div>
  </div>

  <dba-ui-select
    label="Aspect Ratio"
    [value]="simService.currentAspectRatio()"
    (valueChange)="updateAspectRatio($event)"
    [options]="ratioOptions"
  ></dba-ui-select>

  <!-- Sliders -->
  @for (control of controlNames; track control) {
    <dba-ui-slider
      [label]="controlConfig[control].label"
      [value]="getControlValue(control)"
      [min]="controlConfig[control].min"
      [max]="controlConfig[control].max"
      [step]="controlConfig[control].step"
      [precision]="controlConfig[control].precision"
      [tooltip]="controlConfig[control].description"
      (valueChange)="updateControlValue(control, $event)"
    ></dba-ui-slider>
  }

  <!-- Restart Animation & Reset Params Buttons -->
  <div class="pt-1 md:pt-2 flex gap-2">
    <button
      (click)="restartAnimation()"
      [disabled]="!simService.isImageLoaded() || simService.recordingState() !== 'idle'"
      title="Restarts playing the animation from the beginning."
      class="flex-1 py-1.5 md:py-2 text-[10px] md:text-xs font-bold uppercase tracking-widest rounded-none border border-neon-pink/30 bg-neon-pink/5 hover:bg-neon-pink/15 text-neon-pink/80 hover:text-neon-pink transition-all duration-300 cursor-pointer disabled:opacity-40 disabled:cursor-not-allowed"
    >
      ↺ Reset Animation
    </button>
    <button
      (click)="resetParams()"
      [disabled]="simService.recordingState() !== 'idle'"
      title="Reset all parameters (zoom speed, rotation, star settings) to default values"
      class="flex-1 py-1.5 md:py-2 text-[10px] md:text-xs font-bold uppercase tracking-widest rounded-none border border-neon-pink/30 bg-neon-pink/5 hover:bg-neon-pink/15 text-neon-pink/80 hover:text-neon-pink transition-all duration-300 cursor-pointer disabled:opacity-40 disabled:cursor-not-allowed"
    >
      ⟲ Reset Params
    </button>
  </div>

  <!-- Video Recording Button & Checkbox -->
  <div class="pt-0.5 md:pt-1 space-y-2">
    <button
      (click)="toggleRecording()"
      [disabled]="simService.recordingState() === 'processing' || !simService.isImageLoaded()"
      [class]="buttonClass"
      title="Record up to 30 seconds of the animation as a video file"
      class="w-full py-2 md:py-3 text-xs md:text-sm font-bold uppercase tracking-widest rounded-none border border-neon-pink/50 transition-all duration-300 shadow-[0_0_15px_rgba(255,45,149,0.1)] hover:shadow-[0_0_25px_rgba(255,45,149,0.3)]"
    >
      {{ buttonText }}
    </button>

    <dba-ui-checkbox
      label="From Beginning"
      [checked]="simService.recordFromBeginning()"
      [disabled]="simService.recordingState() !== 'idle'"
      (checkedChange)="simService.recordFromBeginning.set($event)"
      class="text-[10px]"
    >
      <span class="tooltip-container relative inline-block ml-1">
        <img
          src="assets/icons/question-mark-circle.svg"
          alt="Help"
          class="w-[16px] h-[16px] cursor-help"
        />
        <span
          class="tooltip-text absolute left-0 bottom-full mb-2 w-64 p-4 bg-space-black/95 border border-neon-pink/30 text-[13px] text-white/90 font-normal normal-case tracking-normal leading-relaxed z-50 opacity-0 invisible transition-all duration-200"
        >
          When enabled, the animation resets to its initial position (zoom = 1.0, rotation = 0)
          before recording starts.
        </span>
      </span>
    </dba-ui-checkbox>
  </div>
</div>
